@echo off
net session >nul 2>&1
if %errorLevel% neq 0 (
    powershell "Start-Process '%~f0' -Verb RunAs"
    exit /b
)

set base="C:\Program Files (x86)\Microsoft\EdgeWebView\Application"


echo Yeni inbound kurallar ekleniyor...
for /d %%D in (%base%\*) do (
    if exist "%%D\msedgewebview2.exe" (
        set ver=%%~nxD
        echo Inbound engelleniyor: %%D\msedgewebview2.exe
        netsh advfirewall firewall add rule name="Block_WebView2_Inbound_!ver!" dir=in action=block program="%%D\msedgewebview2.exe" enable=yes profile=any
    )
)

echo TAMAMLANDI.
exit
